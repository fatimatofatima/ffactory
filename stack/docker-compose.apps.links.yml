name: ffactory
networks: { ffactory_ffactory_net: { external: true } }
services:
  social-correlator:
    build: { context: ../apps/social-correlator, dockerfile: Dockerfile }
    container_name: ffactory_social_correlator
    env_file: [ ../.env ]
    environment:
      - DB_HOST=db
      - DB_PORT=5432
      - POSTGRES_DB=$${POSTGRES_DB}
      - POSTGRES_USER=$${POSTGRES_USER}
      - POSTGRES_PASSWORD=$${POSTGRES_PASSWORD}
      - NEO4J_URI=bolt://neo4j:7687
      - NEO4J_USER=$${NEO4J_USER}
      - NEO4J_PASSWORD=$${NEO4J_PASSWORD}
    networks: [ ffactory_ffactory_net ]
    ports: [ "127.0.0.1:8088:8080" ]
    healthcheck:
      test: ["CMD","wget","-qO-","http://localhost:8080/health"]
      interval: 10s
      timeout: 5s
      retries: 30
